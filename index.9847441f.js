const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.score=0,this.status="idle",this.initialState=t,this.state=this.cloneState(this.initialState)}cloneState(t){return t.map(t=>[...t])}createRandomCell(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.state[e][s]&&t.push([e,s]);if(t.length>0){let e=Math.floor(Math.random()*t.length),[s,a]=t[e];this.state[s][a]=.9>Math.random()?2:4}}combineCell(t){let e=t.filter(t=>0!==t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,this.score+=e[t]);return e.filter(t=>0!==t)}rotateState(t){let e=[];for(let s=0;s<4;s++){e[s]=[];for(let a=3;a>=0;a--)e[s].push(t[a][s])}return e}rotateStateBack(t){let e=[];for(let s=0;s<4;s++){e[s]=[];for(let a=0;a<4;a++)e[s].push(t[a][s])}return e.reverse()}moveRowLeft(t){let e=this.combineCell(t);for(;e.length<4;)e.push(0);return e}moveRowRight(t){let e=this.combineCell(t);for(;e.length<4;)e.unshift(0);return e}moveStateLeft(t){let e=[];for(let s of t)e.push(this.moveRowLeft(s));return e}moveStateRight(t){let e=[];for(let s of t)e.push(this.moveRowRight(s));return e}moveStateUp(t){let e=this.rotateState(t),s=this.moveStateRight(e);return this.rotateStateBack(s)}moveStateDown(t){let e=this.rotateState(t),s=this.moveStateLeft(e);return this.rotateStateBack(s)}move(t){if("playing"!==this.status)return;let e=this.cloneState(this.state);if(this.checkGameStatus(),this.hasEmptyCell||this.canCombineCells)switch(t){case"left":this.state=this.moveStateLeft(this.state);break;case"right":this.state=this.moveStateRight(this.state);break;case"up":this.state=this.moveStateUp(this.state);break;case"down":this.state=this.moveStateDown(this.state)}return!this.areStatesEqual(this.state,e)}moveLeft(){this.move("left")&&(this.createRandomCell(),this.checkGameStatus())}moveRight(){this.move("right")&&(this.createRandomCell(),this.checkGameStatus())}moveUp(){this.move("up")&&(this.createRandomCell(),this.checkGameStatus())}moveDown(){this.move("down")&&(this.createRandomCell(),this.checkGameStatus())}checkGameStatus(){if(!this.hasEmptyCell()&&!this.canCombineCells()){this.status="lose";return}for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(2048===this.state[t][e]){this.status="win";return}}hasEmptyCell(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.state[t][e])return!0;return!1}canCombineCells(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(e<3&&this.state[t][e]===this.state[t][e+1]||t<3&&this.state[t][e]===this.state[t+1][e])return!0;return!1}areStatesEqual(t,e){for(let s=0;s<4;s++)for(let a=0;a<4;a++)if(t[s][a]!==e[s][a])return!1;return!0}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){"idle"===this.status&&(this.status="playing",this.createRandomCell(),this.createRandomCell())}restart(){("playing"===this.status||"lose"===this.status)&&(this.state=this.cloneState(this.initialState)),this.status="idle",this.score=0}},e=document.querySelectorAll(".field-cell"),s=document.querySelector("button");function a(){let s=t.getState(),a=0;for(let t=0;t<4;t++)for(let r=0;r<4;r++){let i=e[a];i.className="field-cell",0!==s[t][r]?(i.textContent=s[t][r],i.classList.add(`field-cell--${s[t][r]}`)):i.textContent="",a++}document.querySelector(".game-score").textContent=t.getScore();let r=t.getStatus();"win"===r?document.querySelector(".message-win").classList.remove("hidden"):"lose"===r&&document.querySelector(".message-lose").classList.remove("hidden")}document.addEventListener("keydown",e=>{if("playing"===t.getStatus()){switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}a()}}),s.addEventListener("click",()=>{"button restart"===s.className&&t.restart(),t.start(),s.textContent="Restart",s.className="button restart",a(),document.querySelector(".message-win").classList.add("hidden"),document.querySelector(".message-lose").classList.add("hidden"),document.querySelector(".message-start").classList.add("hidden")});
//# sourceMappingURL=index.9847441f.js.map
